#!/bin/sh -e

check_protocol_host_and_path()
{
	local IFS='='
	while read -r name value
	do
		case "$name" in
			protocol)
				protocol=$value ;;
			host)
				host=$value ;;
			path)
				path=$value ;;
		esac
	done
	if [ "$protocol" = "https" ] && [ "$host" = "github.com" ] && [ "$path" = "$GITHUB_REPOSITORY.git" ]; then
		return 0
	else
		return 1
	fi
}

case "$1" in
	"get")
		if check_protocol_host_and_path; then
			echo protocol="https"
			echo host="github.com"
			echo path="$GITHUB_REPOSITORY"
			echo username="x-access-token"
			echo password="$GITHUB_TOKEN"
		fi
		exit 0
		;;
	store|erase)
		exit 0
		;;
esac

exit 1
